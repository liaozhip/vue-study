# vue2.X 组件通信方式大全

## 1. props

- 父组件使用属性传值, 比如在父组件中:
  
```javascript
// 父组件向子组件传递了一个name属性, 值是 hi.
<Child name="hi"></Child>

// 或者是使用v-bin 可以简写成一个":", 来传递一个动态的属性.
<Child :name="msg"></Child>
```

- 子组件使用 props 来接收这个属性.

```javascript
export default {
  props: ['name']
}
```

- 更多高级用法: [vue官网](https://cn.vuejs.org/v2/guide/components-props.html#Prop-%E9%AA%8C%E8%AF%81)

## 2. 自定义事件

- 父组件使用 v-on 或者是一个 **符号@** 来自定义一个事件, 如下代码:

```javascript
// 在父组件中, 自定义一个onMessage事件
<template>
  <Child @onMessage="msg"></Child>
</template>

export default {
  methods: {
    msg() {
      console.log('子组件触发')
    }
  }
}
```

- 子组件通过$emit来提交这个事件, 如下代码:

```javascript
<template>
  <button @click="onClick">点击触发onMessage</button>
</template>

export default {
  methods: {
    onClick() {
      this.$emit('onMessage')
    }
  }
}
```

## 3. 事件总线

- vue提供的api: **\$on** 用来全局监听一个自定义事件, 事件由 **\$emit** 来触发, 代码如下:
  
```javascript
// 创建一个全局的事件总线 $bus
Vue.prototype.$bus = new Vue();

// 父组件
this.$bus.$on('eventName', funcName)
// 子组件
this.$bus.$emit('eventName', args)
```

## 4. provide/inject

- 在父组件中使用 **provide** 提供数据, 然后在需要数据的子组件中使用 **inject** 来注入.

```javascript
// 父组件中, 把父组件自己传递给后代组件
export default {
  provide() {
    return {
      parent: this
    }
  }
}

// 在子组件中, 用 inject 接收
export default {
  inject: ['parent']
}
```

- 更多高级用法：[provide/inject](https://cn.vuejs.org/v2/api/#provide-inject)

## 5. $root

- vue提供用来访问根组件的api: `<div id="app"></div>`

## 6. $parent

- vue提供用来访问父组件的api.

## 7. $children

- vue提供用来访问子组件的api.
- 注意: 子组件渲染时不保证顺序.

## 8. $refs

- 用来访问组件实例, 如果不是组件则访问的是 dom 元素.

```javascript
// 拿到的是一个普通的div元素, 使用 this.$refs['div'] 获取
<div ref="div"></div>

// 拿到的是一个组件实例, 使用 this.$refs['child'] 获取
<Child ref="child"></Child>
```

## 9. $attrs

- 父组件传递子组件中没有用 props 接收, 在子组件中就可以使用 $attrs 获取到.
- 注意: 写在组件上的属性如果没有用 props 处理, 默认会被当成原生属性挂载在上面, 这时可以通过在子组件中添加 inheritAttrs: false 来去掉这些默认行为.

- 详情请看vue官网: [inheritAttrs](https://cn.vuejs.org/v2/api/#inheritAttrs)

## 10. $listeners

- 获取所有父组件中(不含 .native 修饰符的) v-on/@ 监听的所有事件.

## 11. vuex

- vue官方提供的全局状态管理插件
- 用法: [vuex官网](https://vuex.vuejs.org/zh/)
